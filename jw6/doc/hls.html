<!doctype html>
<html>
<head>
<title>Using Apple HLS Streaming</title>
<style>
    body { padding: 50px 100px; width: 700px; font: 13px/20px Arial; background: #FFF; }
    a, h1, h2 { color: #369; }
    h1 { font-size: 32px; }
    h2 { margin-top: 50px; }
    h3 { margin-top: 25px; }
    img { display: block; margin: 0 auto; box-shadow: 0 0 5px #999; }
    pre { font-size: 12px; background: #E5F3C8; padding:5px 10px; border: 1px solid #D3EAA4; }
    dt { padding-left: 20px; font-weight: bold; }
    dd { color: #333; font-style: italic; }
    table { width: 100%; border-collapse: collapse; margin: 20px 0; }
    tr { border-bottom: 1px solid #CCC; } 
    tr:nth-child(even) { background: #EEE; }
    td,th { padding: 5px; font-size: 12px; text-align: left; }

</style>
</head><body>

<h1>Using Apple HLS Streaming</h1>

<p>This guide provides an overview on playing Apple HLS streams with JW6.</p>


<h2>Introduction</h2>

<p>Apple's <a href="https://developer.apple.com/resources/http-streaming/">HTTP Live Streaming</a> (HLS) is a protocol for streaming video using an ordinary web server. It supports live and on-demand streaming, as well as the ability to automatically <em>adapt</em> the stream quality to device and network conditions. The protocol works as follows:</p>

<ol>
<li>An existing file or live stream is segmented before delivery into short files.</li>
<li>These segments are stored on a standard webserver and individually requested by a video player.</li>
<li>During playback, the player seamlessly stitches the segments together.</li>
</ol>

<p>If multiple qualities of a stream are available, the player will continuously monitor the current bandwidth and pick the next fragment from the highest quality it can load. This is called <em>Adaptive Streaming</em>:</p>

<p><img src="assets/hls-streaming.jpg" alt="an image of how adaptive streaming works" /></p>

<p>Various protocols for HTTP adaptive streaming are in the market today. JW Player supports HTTP Live Streaming, because it's currently the only protocol capable of streaming to desktop computers as well as to Apple's iPad and iPhone devices.</p>



<h2>JW6 Support</h2>

<p>JW Player <a href="media.html">supports HLS</a> for iPad/iPhone in HTML5 mode and HLS for desktop browsers in Flash mode. JW Player does not support HLS for Android devices.</p>

<p>On the iPhone and iPad, HLS support is built into the iOS system. Therefore, see Apple's <a href="https://developer.apple.com/resources/http-streaming/">HTTP Live Streaming Overview</a> for details on supported features.</p>

<p>On desktops in Flash mode, JW Player supports:</p>

<ul>
<li>All features of <a href="http://tools.ietf.org/html/draft-pantos-http-live-streaming-05">Version 5 of the HLS IETF draft</a>, with the exception of AES decryption. Features introduced in subsequent versions of the IETF draft, like range requests or alternative renditions, are not supported.</li>
<li>Self-initializing TS fragments that contain H.264 video (Baseline or Main) and/or AAC audio (Low Complexity). A TS fragment is self-initializing if it starts with PMT/PAT definitions and a full H264 IDR frame.</li>
</ul>

<p>Fragments that do not meet these requirements will introduce rendering errors in JW Player, ranging from short stutters and macroblock artefacts to an eventual stall of the stream.</p>

<p>In practice, JW6 is compatible with HLS streams generated by the <a href="http://www.wowza.com/">Wowza Media Server</a> and <a href="http://www.adobe.com/products/flash-media-server-family.html">Adobe Media Server</a>, as well as the <strong>mediafilesegmenter</strong> and <strong>mediastreamsegmenter</strong> tools Apple provides. Many additional encoding and segmenting tools may provide compatible streams, but this is not guaranteed.</p>

<p>Since HLS streams are transported over standard HTTP, any CDN can be used for their delivery.</p>



<h2>Embedding a Stream</h2>

<p>Embedding an HLS stream using JW Player is a matter of providing the location to the stream's <strong>M3U8</strong> manifest file. All info can be found in the <a href="embedding.html">embedding guide</a>, but here's a basic setup:</p>

<pre>
jwplayer("myElement").setup({
    file: "/assets/myStream.m3u8",
    image: "/assets/myPoster.jpg"
});
</pre>

<p>Since HLS is not supported on Android, this setup will result in an <em>Unsupported Format</em> setup error on these devices. For live streams, this cannot be avoided. For on-demand streams, Android support can be added by offering an additional MP4 file of the video:</p>

<pre>
jwplayer("myElement").setup({
    playlist: [{
        image: "/assets/myPoster.jpg",
        sources: [{ 
            file: "/assets/myStream.m3u8"
        },{
            file: "/assets/myVideo.mp4"
        }]
    }],
    primary: "flash"
});
</pre>

<p>Next to <a href="playlists.html">a playlist block</a>, this setup includes the <a href="embedding.html">primary</a> option, set to <strong>flash</strong>. If this is not set, JW Player will attempt to play the video in HTML5. Because one of the sources is MP4, this will succeed for Chrome, IE9 and Safari.</p>



<h2>Adaptive Streaming</h2>

<p>If the M3U8 manifest provided contains so-called <em>variant playlists</em>, JW Player will automatically start playing the highest quality stream that fits the bandwidth and the screen size. JW Player will automatically adjust the stream if the bandwidth increases or decreases during playback.</p>

<p>At the same time, users are able to select their quality of choice through a <em>Quality</em> menu in the controlbar. In addition to the preselected <em>Auto</em> option, all variant streams are available. If a user chooses a distinct stream, the automated quality switching is disabled:</p>

<p><img src="assets/hls-quality.jpg" alt="The quality selection menu for an HLS stream in JW6" /></p>

<p>The labels for these options are automatically generated from the M3U8 file. If the file has <em>RESOLUTION</em> options set, the height (+ "p") is displayed. If only <em>BANDWIDTH</em> options are provided, the bitrate (+ "kbps") is displayed. Here is an M3U8 manifest that provides both:</p>

<pre>
#EXTM3U
#EXT-X-STREAM-INF:PROGRAM-ID=1,BANDWIDTH=1600000,RESOLUTION=1280x720
1280/prog_index.m3u8
#EXT-X-STREAM-INF:PROGRAM-ID=1,BANDWIDTH=832000,RESOLUTION=640x360
640/prog_index.m3u8
#EXT-X-STREAM-INF:PROGRAM-ID=1,BANDWIDTH=320000,RESOLUTION=320x180
320/prog_index.m3u8
</pre>

<p>Note that JW Player also uses <em>RESOLUTION</em> to determine the aspect ratio of a stream. If it is not set, JW Player presumes a default aspect ratio of 16:9.</p>

</body>
</html>